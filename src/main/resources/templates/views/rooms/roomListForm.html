<!DOCTYPE html>
<html lang="en"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/main}">
<th:block layout:fragment="content">
    <div class="container mt-5">
        <div class="card mb-4">
            <div class="card-header">
                <i class="fas fa-comments me-1"></i>채팅방:
                <span class="text-primary fw-bold" th:text="${rooms != null ? rooms.size() : 0}">0</span>개
                <button type="button" class="btn btn-primary btn-sm float-end ms-2"
                    th:onclick="|location.href='@{/room/create}'|">방 만들기</button>
            </div>
            <div class="card-body">
                <div class="table-responsive">
                    <table class="table table-bordered table-hover align-middle text-center">
                        <thead class="table-light">
                        <tr>
                            <th>방 번호</th>
                            <th>방 이름</th>
                            <th>방 인원수</th>
                            <th>방 종류</th>
                            <th>방 삭제</th>
                        </tr>
                        </thead>
                        <tbody>
<!--                        <tr th:each="rooms : ${rooms}" th:onclick="|window.location='@{/room/{id}(id=${rooms.id})}'|" style="cursor: pointer;">-->
                        <tr th:each="rooms : ${rooms}" th:onclick="|checkPassword('${rooms.id}')|" style="cursor: pointer;">
                            <td th:text="${rooms.id}"></td>
                            <td th:text="${rooms.name}"></td>
                            <td th:text="${rooms.currentMembers} + '/' + ${rooms.max}"></td>
                            <td th:text="${rooms.type}"></td>
                            <td>
                                <a>방 삭제</a>
                            </td>
                        </tr>

                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <script th:inline="javascript">
        <!-- Thymeleaf 변수를 전역 JS 변수로 선언 -->
        const memberSession = /*[[${memberSession}]]*/ null;
        const roomInfo = /*[[${rooms}]]*/ [];

        <!-- localStorage 세션 저장 로직 -->
        localStorage.setItem('memberSession', JSON.stringify(window.memberSession));
    </script>

    <script type="module" th:src="@{/js/password.js}"></script>

</th:block>
</html>

